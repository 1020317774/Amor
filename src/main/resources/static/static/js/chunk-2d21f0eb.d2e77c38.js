(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21f0eb"],{d7ce:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"columns"},[r("div",{staticClass:"column is-full"},[r("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[r("i",{staticClass:"fa fa fa-book"},[e._v(" 主题 / 发布主题")])])]),r("div",[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules}},[r("el-form-item",{attrs:{prop:"title"}},[r("el-input",{attrs:{placeholder:"输入主题名称"},model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1),r("el-form-item",{attrs:{prop:"categoryId"}},[r("el-select",{attrs:{placeholder:"请选择主题分类"},model:{value:e.ruleForm.categoryId,callback:function(t){e.$set(e.ruleForm,"categoryId",t)},expression:"ruleForm.categoryId"}},e._l(e.categoryList,(function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),r("div",{attrs:{id:"vditor"}}),r("b-taginput",{staticClass:"my-3",attrs:{maxlength:"15",maxtags:"3",ellipsis:"",placeholder:"请输入主题标签，限制为 15 个字符和 3 个标签"},model:{value:e.ruleForm.tags,callback:function(t){e.$set(e.ruleForm,"tags",t)},expression:"ruleForm.tags"}}),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("立即创建 ")]),r("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")])],1)],1)],1)])],1)])},o=[],l=r("0fac"),s=r("ff41"),i=r.n(s),n=(r("2f2f"),r("b775"));function c(e){return Object(n["a"])({url:"/category/list",method:"post",params:{page:e.page,size:e.size}})}var u={name:"topic-post",data:function(){return{contentEditor:"",categoryList:[],pageParam:{page:1,size:10},ruleForm:{title:"",categoryId:"",tags:[],content:{}},rules:{title:[{required:!0,message:"请输入话题名称",trigger:"blur"},{min:1,max:25,message:"长度在 1 到 25 个字符",trigger:"blur"}],categoryId:[{required:!0,message:"请选择话题分类",trigger:"change"}]}}},watch:{$route:"fetchCategoryList"},mounted:function(){this.contentEditor=new i.a("vditor",{height:360,placeholder:"此处为话题内容……",theme:"light",preview:{hljs:{style:"monokai"}},toolbarConfig:{pin:!0},cache:{enable:!1},mode:"sv",upload:{accept:"image/*,.mp3, .wav, .rar",url:"http://127.0.0.1:10000/upload/file",fieldName:"file",linkToImgCallback:function(e){alert(1),alert(e)},success:function(e,t){return console.log(e),console.log(t),!0},error:function(e){console.log(e||"文件上传失败")}}})},created:function(){this.fetchCategoryList()},methods:{fetchCategoryList:function(){var e=this;c(this.pageParam).then((function(t){var r=t.data;e.pageParam.page=r.current,e.pageParam.size=r.size,e.categoryList=r.records}))},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){return e?1===t.contentEditor.getValue().length||null==t.contentEditor.getValue()||""===t.contentEditor.getValue()?(alert("话题内容不可为空"),!1):null==t.ruleForm.tags||0===t.ruleForm.tags.length?(alert("标签不可以为空"),!1):(t.ruleForm.content=t.contentEditor.getValue(),void Object(l["e"])(t.ruleForm).then((function(e){var r=e.data;setTimeout((function(){t.$router.push({name:"topic-detail",params:{id:r.id}})}),800)}))):(console.log("error submit!!"),!1)}))},resetForm:function(e){this.$refs[e].resetFields(),this.contentEditor.setValue(""),this.ruleForm.tags=""}}},m=u,d=r("2877"),g=Object(d["a"])(m,a,o,!1,null,"452fa7a8",null);t["default"]=g.exports}}]);